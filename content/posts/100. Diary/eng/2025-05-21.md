---
title: 2025-05-21
date: 2025-05-21
---

### 하루 일지 요약

#### 기상 / 숙면 시간
- 어제는 11시 20분에 잠들었다.
- 오늘은 6시 40분에 일어났다. 일어나서 뉴스를 틀었다. 

#### 업무 및 공부 ..
- 데이터센터 네트워크 책 진행을 못했다.
- 대신 대규모 데이터 센터에서 오픈스택 클러스터를 어떤 식으로 구성해야 하는지에 대해 고민했다.( gpt와 대화하면서 ... 신뢰성은 모르겠다 )
  - 컨트롤러 / 네트워크 / 컴퓨트 / 스토리지 영역을 나누는 것은 기본이다.
  - 랙 4대에 각 서버 10개씩 넣는다고 가정했다.
  - 각 랙 상단에 2~3개의 리프 스위치를 둔다고 생각했다. 각각 퍼블릭, 관리, 스토리지 용도이며, 이더넷 망에서 VLAN 혹은 VRF로 나눌 수 있다. 다만, 실전 경험이 없기 때문에 정말 이런 식으로 구성해야 하는지는 잘 모르겠다.
  - 스파인 스위치와 리프 스위치 연결은 25G로 구성하고, 리프 스위치와 서버 연결은 10G로 구성한다. 스파인 스위치는 경계 스위치(Border Switch)와 또 연결되어 있으며, Border는 이중화된 라우터(R1/R2)와 연결된다.
  - 이중화된 라우터는 방화벽, 로드밸런서, 외부 BGP 피어 등을 바라보고 있으며, 결국 외부와의 통신 관점에서 네트워크 출입구 역할을 한다.
  - 컨트롤러 서버는 HA 구성을 위해 3대로 구성한다. 여기에는 API, 데이터베이스, 메시지 큐, 스케줄러, OVN-Northd 등을 배치할 수 있다.
  - 컴퓨트는 총 20대로 구성하고, 각각 듀얼 소켓 기반 CPU (56vCPU 수준)와 256\~384GB RAM 정도를 가정했다. Overcommit 비율은 CPU 2:1, RAM 1.2:1 정도로 잡으면 c2m4 스펙(2vCPU / 4GB RAM) 기준으로 대당 약 50~60대 정도의 VM을 안정적으로 배포할 수 있다. 전체 Compute 용량 기준으로는 약 1,120대의 VM을 수용할 수 있다.
  - 스토리지는 Ceph를 가정했고, 10대의 OSD 서버에 12TB HDD 12개씩 구성했다. 이를 기준으로 총 raw 용량은 1,440TB이며, 3중 복제를 기준으로 usable 용량은 약 480TB 정도가 된다. 이를 기반으로 하면 VM당 평균 약 400GB 가량의 블록 스토리지(RBD)를 할당할 수 있고, 운영 시에는 스냅샷, 백업 등을 고려하여 300~350GB 수준으로 관리할 수 있을 것이다.
  - Ceph OSD 서버는 16\~24코어, 128\~192GB RAM을 가진 중급 이상의 스토리지 노드로 설정하며, 1 OSD당 약 1.0\~1.5 vCPU, 4\~6GB RAM이 필요하다는 Ceph 가이드라인을 참고했다. 따라서 서버당 12개 디스크 구성이라면 12 OSD 기준으로 16코어는 가능한 하한이며, 여유를 두고 설계한다면 24코어가 더 적절할 수 있다.
  - 나머지 7대는 네트워크/인프라 영역으로 분류되며, 모니터링, 로깅, 메트릭 수집, 배스천 서버, CI/CD 엔진, RadosGW, 백업 노드 등으로 활용할 수 있다. 실제 운영 시에는 이 노드들이 가볍게 보이지만, 지속적인 로깅, 리텐션, 메트릭 수집이 클러스터 전체 성능에 영향을 주기 때문에 독립 배치가 바람직하다.
  - OVN 사용을 기본으로 생각했고, NS 트래픽은 BGP/EVPN 등을 고려하고, EW 트래픽은 Geneve를 고려했다. EW 쪽에서 SR-IOV/DPDK 도 옵션이라 하는데, 조금 난이도가 있게 느껴진다.
  - 그래서 이런 구성에서 실제 스위치, 라우터 설정을 어떻게 해야하는 것일까 ... 라는 어려운 숙제를 가지고 있다.
- 내일은 KCD 2025에 참석하기 위해서 대강 8시 30분에 출발해야 한다.

#### 이외의 생각
- 더워진다. 저녁 먹을 때 너무 덥고 꿉꿉해서 선풍기를 꺼냈다. 아직 청소가 안 된거라 찝찝하긴 했는데 더운 건 참을 수 없었다.
- 밥 먹을 때 보통 윈도우 컴퓨터로 유튜브를 보는데, 오늘은 무슨 날인지 컴퓨터가 갑자기 죽어버렸다. 허탈한 마음으로 본체 분리해서 전원선 뽑고 다른 곳 가서 잠시 기다렸다가 다시 연결하니 잘 켜졌다. 이게 뭘까 ... 전원 공급이 불안정한건지, 아니면 다른 문제인지 모르겠다.
- 컴퓨터 분리한 김에 청소도 하고, 구조도 바꿨다. 책상 위의 메인 컴퓨터를 옛날 맥북으로 바꿨다. 이제 좀 더 공부에 집중할 수 있는 환경이 되지 않았을까 ...